<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdown + LaTeX Interpreter</title>
    <!-- Load Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom CSS for better readability and structure */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
        }
        /* Style for the rendered content */
        #rendered-output {
            line-height: 1.7;
        }
        /* Custom styling for rendered Markdown elements */
        #rendered-output h1, #rendered-output h2, #rendered-output h3 {
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: 700;
        }
        #rendered-output p {
            margin-bottom: 1rem;
        }
        /* Style for code blocks */
        #rendered-output pre {
            background-color: #1f2937; /* Dark gray background */
            color: #f3f4f6; /* Light text */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
            margin-bottom: 1rem;
        }
        /* Ensure MathJax output scales well */
        .MathJax {
            font-size: 1.1em;
        }
    </style>
    <!-- Configure MathJax 3 to use $...$ for inline math -->
    <script>
        window.MathJax = {
            tex: {
                // Enable single dollar signs for inline math
                inlineMath: [['$', '$'], ['\\(', '\\)']],
                // Enable double dollar signs for display math
                displayMath: [['$$', '$$'], ['\\[', '\\]']],
                processEscapes: true,
                processEnvironments: true
            },
            options: {
                skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code'],
                ignoreHtmlClass: 'tex2jax_ignore',
                processHtmlClass: 'tex2jax_process'
            }
        };
    </script>
    <!-- Load MathJax 3 (must be loaded after the config block) -->
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <!-- Load Marked.js for Markdown to HTML conversion -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-6xl mx-auto bg-white shadow-xl rounded-xl p-6 lg:p-10">
        <h1 class="text-4xl font-extrabold text-gray-900 mb-6 border-b pb-2">
            Static Document Renderer
        </h1>

        <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Input Panel -->
            <div class="flex flex-col">
                <h2 class="text-2xl font-bold text-indigo-700 mb-4">
                    Markdown Source
                </h2>
                <textarea
                    id="markdown-input"
                    class="flex-grow w-full h-96 p-4 border border-gray-300 rounded-lg resize-none focus:ring-indigo-500 focus:border-indigo-500 font-mono text-sm shadow-inner"
                    placeholder="Type your markdown and LaTeX here..."
                    spellcheck="false"
                ># Welcome to your Static Site!

This entire document is rendered client-side from Markdown.

## Features:
1.  **Markdown:** Write headings, lists, and links.
2.  **Code Blocks:** Use triple backticks (```) for code.
3.  **Inline LaTeX:** Use single dollar signs (e.g., $x^2 + y^2 = r^2$).
4.  **Display LaTeX:** Use double dollar signs (e.g., $$\int_{-\infty}^{\infty} e^{-x^2} dx = \sqrt{\pi}$$)

## Mathematics Example
The quadratic formula, which solves for $x$ in the equation $ax^2 + bx + c = 0$, is expressed as:
$$x = \frac{-b \pm \sqrt{b^2 - 4ac}}{2a}$$
We can also talk about the derivative of $\sin(x)$, which is $\cos(x)$, or calculate the area of a circle using $A = \pi r^2$.

## Simple List
* Item one.
* Item two.
* Item three.

```javascript
// A simple function example
function calculate(a, b) {
    return a + b;
}
```
</textarea>
            </div>

            <!-- Output Panel -->
            <div class="flex flex-col">
                <h2 class="text-2xl font-bold text-green-700 mb-4">
                    Rendered Output
                </h2>
                <div
                    id="rendered-output"
                    class="flex-grow p-4 border border-gray-300 bg-gray-50 rounded-lg shadow-inner overflow-y-auto"
                >
                    <!-- Content will be rendered here -->
                </div>
            </div>
        </div>
    </div>

    <script>
        const input = document.getElementById('markdown-input');
        const output = document.getElementById('rendered-output');

        /**
         * Renders the markdown content and then processes LaTeX.
         */
        function renderContent() {
            const markdownText = input.value;

            // 1. Convert Markdown to HTML using marked.js
            // Ensure marked is available globally
            const html = window.marked.parse(markdownText);

            // 2. Insert the HTML into the output container
            output.innerHTML = html;

            // 3. Ask MathJax to scan the newly inserted content and typeset the math.
            // MathJax.typesetPromise() is the best way to process new content dynamically.
            if (typeof MathJax !== 'undefined') {
                MathJax.typesetPromise([output])
                    .catch((err) => console.error("MathJax typesetting error:", err));
            } else {
                console.warn("MathJax is not yet loaded or initialized.");
            }
        }

        // --- Event Listeners and Initial Load ---

        // Render content immediately when the page loads
        window.onload = function() {
            // Wait a moment for MathJax to initialize its configuration
            setTimeout(renderContent, 50);
        };

        // Re-render content every time the user types
        input.addEventListener('input', renderContent);

        // Optional: Ensure the initial rendering happens even if onload fires quickly
        if (input.value) {
            // Small delay to ensure all CDNs are loaded, especially MathJax
            setTimeout(renderContent, 100);
        }

    </script>
</body>
</html>
